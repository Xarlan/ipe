!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}({7:function(e,t,n){e.exports=n(8)},8:function(e,t){var n=document.getElementsByClassName("vuln__delete-btn")[0],a=document.getElementsByClassName("vuln__edit-btn")[0],r=document.getElementsByClassName("attach__upload")[0];n.addEventListener("click",(function(){confirm("Are you sure you want to delete vuln ?")&&fetch(SERVER_PROTO+SERVER_HOST+"/api/deleteVulnerability",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({vuln_id:vuln_id})}).then((function(e){return e.json()})).then((function(e){1===e.status?window.location=SERVER_PROTO+SERVER_HOST+"/project/"+project_id:alert(e.error)})).catch((function(e){return alert(e)}))})),a.addEventListener("click",(function(){var e,t,n,a,r=document.querySelector("input[name=name]").value,o=document.querySelector("input[name=full_path]").value,c=document.querySelector("textarea[name=description]").value,l=document.querySelector("textarea[name=risk]").value,i=document.querySelector("textarea[name=details]").value,u=document.querySelector("textarea[name=recommendation]").value,s=document.getElementsByClassName("vuln__context"),d=document.querySelectorAll("input[name=criticality]"),p=document.querySelectorAll("input[name=probability]"),m=document.getElementById("vuln-target").value;m.length&&(a=m.split(",").filter((function(e){return e.trim().length>0})).map((function(e){return e.trim()})));for(var h=0;h<s.length;h++)s[h].checked&&(e=s[h].value);for(var _=0;_<d.length;_++)d[_].checked&&(t=d[_].value);for(var f=0;f<p.length;f++)p[f].checked&&(n=p[f].value);fetch(SERVER_PROTO+SERVER_HOST+"/api/editVulnerability",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:project_id,vuln_id:vuln_id,name:r,object:e,full_path:o,criticality:t,probability:n,final_criticality:Math.floor((Number(t)+Number(n))/2),description:c,risk:l,details:i,recommendation:u,target:a&&a.length&&a.length>0?a:[]})}).then((function(e){return e.json()})).then((function(e){1===e.status?window.location="":alert(e.error)})).catch((function(e){return alert(e)}))}));var o=1,c=[];window.handle_attach=function(e){var t=e.closest("li");if(t.querySelector(".attach__name").innerText=e.files[0].name,!c.includes(e.id)){c.push(e.id);var n=document.getElementsByClassName("attach__list")[0],a=document.createElement("li");o++,a.className="attach__item",a.innerHTML='<label for="uploadbtn-'.concat(o,'" class="btn btn-outline-primary scope__add-btn uploadButton">choose attach</label>\n                          <input class="attach__input" type="file" id="uploadbtn-').concat(o,'" accept=".jpg,.jpeg,.png" onchange="handle_attach(this)">\n                          <input type="text" id="attach__description" class="attach__description form-control" name="attach__description" placeholder="description">\n                          <span class="attach__name"></span>\n                          <span class="attach__item-close disabled" onclick="this.closest(\'li\').parentNode.removeChild(this.closest(\'li\'));">X</span>'),n.appendChild(a)}t.querySelector(".attach__item-close.disabled")&&t.querySelector(".attach__item-close.disabled").classList.remove("disabled")},r.addEventListener("click",(function(){for(var e=document.getElementsByClassName("attach__input"),t=0;t<e.length;t++)e[t].files[0]&&function(){var n=e[t],a=e[t].closest(".attach__item").querySelector(".attach__description").value,r=new FormData;r.append("attach",e[t].files[0]),r.append("vuln_id",vuln_id),r.append("description",a);var o=document.getElementsByClassName("attach__existed")[0];fetch(SERVER_PROTO+SERVER_HOST+"/api/uploadFile",{method:"post",body:r}).then((function(e){return e.json()})).then((function(e){if(1===e.status){var t=document.createElement("li");t.innerHTML='<a href="/api/getAttach/'.concat(e.id,'" target="_blank">').concat(e.filename,"</a> - <span>").concat(a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),'</span> - <button class="btn btn-outline-danger attach__delete" onclick="delete_attach(event, ').concat(e.id,')">delete</button>'),o.appendChild(t),n.closest("li").parentNode.removeChild(n.closest("li"))}else alert(e.error)})).catch((function(e){return alert(e)}))}()})),window.delete_attach=function(e,t){e.preventDefault(),confirm("Are you sure you want to delete attachment ?")&&fetch(SERVER_PROTO+SERVER_HOST+"/api/deleteAttach/",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}).then((function(e){return e.json()})).then((function(t){1===t.status?(atta_item=e.target.closest("li"),atta_item.parentNode.removeChild(atta_item)):alert(t.error)})).catch((function(e){return alert(e)}))}}});
//# sourceMappingURL=vuln.js.map