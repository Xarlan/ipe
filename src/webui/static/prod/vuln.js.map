{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/vuln.js"],"names":["vuln_delete_btn","document","getElementsByClassName","vuln_edit_btn","attach_upload_btn","addEventListener","is_delete","confirm","fetch","SERVER_PROTO","SERVER_HOST","method","headers","body","JSON","stringify","vuln_id","then","response","json","data","status","window","location","project_id","alert","error","name","querySelector","value","full_path","description","risk","details","recommendation","context_elems","checked_context","criticality_inputs","querySelectorAll","checked_criticality","probability_inputs","checked_probability","target","getElementById","hosts","request","length","split","filter","host","trim","map","i","checked","object","criticality","probability","final_criticality","Math","floor","Number","attach_number","create_item_flag","handle_attach","attach_item","closest","innerText","files","includes","id","push","attach_list","attach_clone","createElement","className","innerHTML","appendChild","classList","remove","attaches","attach_dom_el","attach_description","formData","FormData","append","uploaded_attach_block","new_attach","filename","replace","parentNode","removeChild","delete_attach","event","preventDefault","atta_item"],"mappings":"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","file":"vuln.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","let vuln_delete_btn = document.getElementsByClassName(\"vuln__delete-btn\")[0];\r\nlet vuln_edit_btn = document.getElementsByClassName(\"vuln__edit-btn\")[0];\r\nlet attach_upload_btn = document.getElementsByClassName(\"attach__upload\")[0];\r\n\r\nvuln_delete_btn.addEventListener(\"click\", () => {\r\n    let is_delete = confirm(\"Are you sure you want to delete vuln ?\");\r\n    if (is_delete) {\r\n        fetch(SERVER_PROTO + SERVER_HOST + \"/api/deleteVulnerability\", {\r\n            method: \"post\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(\r\n                {\r\n                    vuln_id: vuln_id\r\n                }\r\n            )\r\n        })\r\n            .then(response => {\r\n                return response.json();\r\n            })\r\n            .then(data => {\r\n                if (data.status === 1) {\r\n                    window.location = SERVER_PROTO + SERVER_HOST + \"/project/\" + project_id;\r\n                } else {\r\n                    alert(data.error)\r\n                }\r\n            })\r\n            .catch(error => alert(error))\r\n    }\r\n});\r\n\r\nvuln_edit_btn.addEventListener(\"click\", () => {\r\n    let name = document.querySelector(\"input[name=name]\").value;\r\n    let full_path = document.querySelector(\"input[name=full_path]\").value;\r\n    let description = document.querySelector(\"textarea[name=description]\").value;\r\n    let risk = document.querySelector(\"textarea[name=risk]\").value;\r\n    let details = document.querySelector(\"textarea[name=details]\").value;\r\n    let recommendation = document.querySelector(\"textarea[name=recommendation]\").value;\r\n    let context_elems = document.getElementsByClassName(\"vuln__context\"),\r\n        checked_context;\r\n    let criticality_inputs = document.querySelectorAll(\"input[name=criticality]\"),\r\n        checked_criticality;\r\n    let probability_inputs = document.querySelectorAll(\"input[name=probability]\"),\r\n        checked_probability;\r\n    let target = document.getElementById(\"vuln-target\").value,\r\n        hosts;\r\n    let request = document.querySelector(\"textarea[name=request]\").value;\r\n    let response = document.querySelector(\"textarea[name=response]\").value;\r\n    if (target.length) {\r\n        hosts = target.split(\",\").filter(host => {\r\n            return host.trim().length > 0\r\n        }).map(host => {\r\n            return host.trim()\r\n        });\r\n    }\r\n\r\n    for (let i = 0; i < context_elems.length; i++) {\r\n        if (context_elems[i].checked) {\r\n            checked_context = context_elems[i].value;\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < criticality_inputs.length; i++) {\r\n        if (criticality_inputs[i].checked) {\r\n            checked_criticality = criticality_inputs[i].value;\r\n        }\r\n    }\r\n\r\n    for (let i = 0; i < probability_inputs.length; i++) {\r\n        if (probability_inputs[i].checked) {\r\n            checked_probability = probability_inputs[i].value;\r\n        }\r\n    }\r\n\r\n    fetch(SERVER_PROTO + SERVER_HOST + \"/api/editVulnerability\", {\r\n        method: \"post\",\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(\r\n            {\r\n                project_id: project_id,\r\n                vuln_id: vuln_id,\r\n                name: name,\r\n                object: checked_context,\r\n                full_path: full_path,\r\n                criticality: checked_criticality,\r\n                probability: checked_probability,\r\n                final_criticality: Math.floor((Number(checked_criticality) + Number(checked_probability)) / 2),\r\n                description: description,\r\n                risk: risk,\r\n                details: details,\r\n                recommendation: recommendation,\r\n                target: hosts && hosts.length && hosts.length > 0 ? hosts : [],\r\n                request: request,\r\n                response: response,\r\n            }\r\n        )\r\n    })\r\n        .then(response => {\r\n            return response.json();\r\n        })\r\n        .then(data => {\r\n            if (data.status === 1) {\r\n                window.location = \"\";\r\n            } else {\r\n                alert(data.error)\r\n            }\r\n        })\r\n        .catch(error => alert(error))\r\n});\r\n\r\n\r\n\r\nlet attach_number = 1;\r\nlet create_item_flag = [];\r\n\r\nwindow.handle_attach = function (target){\r\n    let attach_item = target.closest(\"li\");\r\n    attach_item.querySelector(\".attach__name\").innerText = target.files[0].name;\r\n    if (!create_item_flag.includes(target.id)){\r\n        create_item_flag.push(target.id);\r\n        let attach_list = document.getElementsByClassName(\"attach__list\")[0];\r\n        let attach_clone = document.createElement('li');\r\n        attach_number++;\r\n        attach_clone.className = \"attach__item\";\r\n        attach_clone.innerHTML = `<label for=\"uploadbtn-${attach_number}\" class=\"btn btn-outline-primary scope__add-btn uploadButton\">choose attach</label>\r\n                          <input class=\"attach__input\" type=\"file\" id=\"uploadbtn-${attach_number}\" accept=\".jpg,.jpeg,.png\" onchange=\"handle_attach(this)\">\r\n                          <input type=\"text\" id=\"attach__description\" class=\"attach__description form-control\" name=\"attach__description\" placeholder=\"description\">\r\n                          <span class=\"attach__name\"></span>\r\n                          <span class=\"attach__item-close disabled\" onclick=\"this.closest('li').parentNode.removeChild(this.closest('li'));\">X</span>`;\r\n        attach_list.appendChild(attach_clone);\r\n    }\r\n\r\n    if(attach_item.querySelector(\".attach__item-close.disabled\")){\r\n        attach_item.querySelector(\".attach__item-close.disabled\").classList.remove(\"disabled\");\r\n    }\r\n};\r\n\r\nattach_upload_btn.addEventListener(\"click\", ()=>{\r\n   let attaches = document.getElementsByClassName(\"attach__input\");\r\n\r\n   for (let i=0; i < attaches.length; i++){\r\n       if(attaches[i].files[0]){\r\n           let attach_dom_el = attaches[i];\r\n           let attach_description = attaches[i].closest(\".attach__item\").querySelector(\".attach__description\").value;\r\n           let formData = new FormData();\r\n           formData.append(\"attach\", attaches[i].files[0]);\r\n           formData.append(\"vuln_id\", vuln_id);\r\n           formData.append(\"description\", attach_description);\r\n\r\n           let uploaded_attach_block = document.getElementsByClassName(\"attach__existed\")[0];\r\n\r\n           fetch(SERVER_PROTO + SERVER_HOST + '/api/uploadFile', {\r\n               method: \"post\",\r\n               body: formData\r\n           })\r\n               .then(response => {\r\n                    return response.json();\r\n                })\r\n                .then(data => {\r\n                    if (data.status === 1) {\r\n                        let new_attach = document.createElement('li');\r\n                        new_attach.innerHTML = `<a href=\"/api/getAttach/${data.id}\" target=\"_blank\">${data.filename}</a> - <span>${attach_description.replace(/&/g, \"&amp;\").replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\").replace(/\"/g, \"&quot;\")}</span> - <button class=\"btn btn-outline-danger attach__delete\" onclick=\"delete_attach(event, ${data.id})\">delete</button>`;\r\n                        uploaded_attach_block.appendChild(new_attach);\r\n                        attach_dom_el.closest(\"li\").parentNode.removeChild(attach_dom_el.closest('li'));\r\n                    } else {\r\n                        alert(data.error)\r\n                    }\r\n                })\r\n                .catch(error => alert(error))\r\n       }\r\n   }\r\n});\r\n\r\nwindow.delete_attach = function(event, id){\r\n    event.preventDefault();\r\n    let is_delete = confirm(\"Are you sure you want to delete attachment ?\");\r\n    if (is_delete){\r\n            fetch(SERVER_PROTO + SERVER_HOST + \"/api/deleteAttach/\", {\r\n            method: \"post\",\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                id: id\r\n            })\r\n        })\r\n            .then(response => {\r\n                return response.json();\r\n            })\r\n            .then(data => {\r\n                if (data.status === 1) {\r\n                    atta_item = event.target.closest(\"li\");\r\n                    atta_item.parentNode.removeChild(atta_item);\r\n                } else {\r\n                    alert(data.error)\r\n                }\r\n            })\r\n            .catch(error => alert(error))\r\n    }\r\n};"],"sourceRoot":""}